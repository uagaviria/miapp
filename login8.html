<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAINFRAME M-734 - 4 DIGIT MODE</title>
    <style>
        :root {
            --metal-dark: #2a2a2a;
            --metal-light: #4a4a4a;
            --rust: #5c3a21;
            --neon-orange: #ff4500;
            --bg: #100805;
        }

        body {
            margin: 0; height: 100vh;
            background-color: var(--bg);
            display: flex; justify-content: center; align-items: center;
            overflow: hidden; user-select: none;
            background-image: radial-gradient(circle at center, #2a1a10 0%, #000 80%);
        }

        .overload-flash { animation: flash 0.1s infinite; filter: contrast(2); }
        @keyframes flash { 0% { background: var(--bg); } 50% { background: #fff; } }
        
        #warning-sign {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-15deg);
            border: 10px solid red; background: yellow; color: black;
            font-family: impact, sans-serif; font-size: 4rem; padding: 30px;
            text-transform: uppercase; display: none; z-index: 999;
            box-shadow: 0 0 50px red;
        }

        .rack-mount {
            width: 500px; 
            background: repeating-linear-gradient(180deg, var(--metal-dark), var(--metal-dark) 10px, var(--metal-light) 10px, var(--metal-light) 12px);
            border: 4px solid #1a1a1a; border-radius: 10px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8), inset 0 0 100px #000;
            padding: 30px; display: flex; flex-direction: column; gap: 30px;
            position: relative;
        }

        .rack-mount::before {
            content: ""; position: absolute; top:0; left:0; width:100%; height:100%;
            background: radial-gradient(circle at 20% 30%, var(--rust) 0%, transparent 20%),
                        radial-gradient(circle at 80% 80%, var(--rust) 0%, transparent 25%);
            opacity: 0.4; pointer-events: none;
        }

        .top-section { display: flex; justify-content: space-between; align-items: center; }

        .nixie-container {
            display: flex; gap: 15px;
            background: #000; padding: 25px; border: 3px solid #333;
            border-radius: 5px; box-shadow: inset 0 0 20px #000;
        }

        .nixie-tube {
            width: 60px; height: 90px; background: rgba(40, 20, 10, 0.3);
            border-radius: 12px 12px 0 0; border: 1px solid rgba(255, 70, 0, 0.2);
            display: flex; justify-content: center; align-items: center;
            font-family: 'Courier New', Courier, monospace; font-size: 4rem; 
            color: rgba(255, 70, 0, 0.1);
            position: relative; 
            transition: color 0.3s, text-shadow 0.3s;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }

        .nixie-tube::after {
            content: ""; position: absolute; top:0; left:0; width:100%; height:100%;
            background: repeating-linear-gradient(0deg, rgba(0,0,0,0.3) 0px, transparent 2px);
            pointer-events: none;
        }

        .warmed-up .nixie-tube {
            color: #ff5500;
            text-shadow: 0 0 5px #ff2200;
        }

        .gauge-container {
            width: 100px; height: 100px; background: #ccc; border-radius: 50%;
            border: 4px solid #333; position: relative; overflow: hidden;
            box-shadow: inset 0 0 10px #000;
        }
        .gauge-face {
            width: 100%; height: 100%; background: conic-gradient(from 180deg, green 0deg, yellow 90deg, red 180deg);
            opacity: 0.8;
        }
        .gauge-needle {
            position: absolute; top: 50%; left: 50%; width: 45%; height: 4px;
            background: black; transform-origin: 0% 50%; transform: rotate(180deg);
            transition: transform 3s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        .controls-section { display: flex; gap: 20px; align-items: center; }

        .ignition-btn {
            width: 100px; height: 100px; background: #800;
            border: 5px solid #400; border-radius: 50%;
            box-shadow: 0 10px 0 #200, 0 15px 20px rgba(0,0,0,0.5);
            cursor: pointer; color: #ccc; font-weight: bold;
            display: flex; justify-content: center; align-items: center;
            text-shadow: 1px 1px 2px #000; transition: 0.2s;
            text-align: center;
        }
        .ignition-btn:active { box-shadow: 0 2px 0 #200, 0 5px 10px rgba(0,0,0,0.5); transform: translateY(8px); }
        .ignition-btn.active { background: #f00; color: yellow; box-shadow: 0 0 30px red; }

        .keypad-industrial {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
            background: #222; padding: 15px; border: 3px solid #111;
            pointer-events: none; opacity: 0.5;
            transition: opacity 1s;
        }
        .warmed-up .keypad-industrial { pointer-events: all; opacity: 1; }

        .key-ind {
            width: 60px; height: 50px; background: #444; border: 2px solid #111;
            color: #ccc; font-weight: bold; font-size: 1.2rem;
            box-shadow: inset 0 5px 0 #555, 0 5px 0 #000;
            cursor: pointer; text-align: center; line-height: 45px;
        }
        .key-ind:active { transform: translateY(4px); box-shadow: inset 0 2px 0 #555, 0 1px 0 #000; }
        .key-clr { background: #622; } .key-ok { background: #252; }

    </style>
</head>
<body>

    <div id="warning-sign">⚡ PELIGRO ⚡<br>ALTO VOLTAJE</div>

    <div class="rack-mount" id="rack">
        <div class="top-section">
            <div class="nixie-container" id="nixie-display">
                <div class="nixie-tube" id="n1">0</div>
                <div class="nixie-tube" id="n2">0</div>
                <div class="nixie-tube" id="n3">0</div>
               
            </div>

            <div>
                <div class="gauge-container">
                    <div class="gauge-face"></div>
                    <div class="gauge-needle" id="temp-needle"></div>
                    <div class="gauge-label" style="position: absolute; bottom: 10px; width: 100%; text-align: center; font-size: 0.7rem; font-weight: bold;">TEMP</div>
                </div>
            </div>
        </div>

        <div class="controls-section">
            <div>
                <button class="ignition-btn" id="ignite-btn" onclick="startWarmup()">IGNICIÓN<br>SISTEMA</button>
            </div>

            <div class="keypad-industrial" id="keypad">
                <button class="key-ind" onclick="pressKey(1)">1</button>
                <button class="key-ind" onclick="pressKey(2)">2</button>
                <button class="key-ind" onclick="pressKey(3)">3</button>
                <button class="key-ind" onclick="pressKey(4)">4</button>
                <button class="key-ind" onclick="pressKey(5)">5</button>
                <button class="key-ind" onclick="pressKey(6)">6</button>
                <button class="key-ind" onclick="pressKey(7)">7</button>
                <button class="key-ind" onclick="pressKey(8)">8</button>
                <button class="key-ind" onclick="pressKey(9)">9</button>
                <button class="key-ind key-clr" onclick="clearCode()">CLR</button>
                <button class="key-ind" onclick="pressKey(0)">0</button>
                <button class="key-ind key-ok" onclick="submitCode()">#</button>
            </div>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let isWarmedUp = false;
        let currentCode = "";
        let humOsc, humGain;

        const CLAVE_CORRECTA = "785"; 

        function initHum() {
            humOsc = audioCtx.createOscillator();
            humOsc.type = 'sine'; humOsc.frequency.value = 60;
            humGain = audioCtx.createGain(); humGain.gain.value = 0;
            humOsc.connect(humGain); humGain.connect(audioCtx.destination);
            humOsc.start();
        }

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const t = audioCtx.currentTime;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);

            if (type === 'spark') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(200, t);
                osc.frequency.exponentialRampToValueAtTime(10000, t + 0.5);
                gain.gain.setValueAtTime(0.5, t); gain.gain.linearRampToValueAtTime(0, t + 0.5);
                osc.start(t); osc.stop(t + 0.5);
            } else if (type === 'clunk') {
                osc.type = 'square'; osc.frequency.setValueAtTime(80, t);
                gain.gain.setValueAtTime(0.8, t); gain.gain.exponentialRampToValueAtTime(0.01, t + 0.1);
                osc.start(t); osc.stop(t + 0.1);
            } else if (type === 'nixie') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(2000, t);
                gain.gain.setValueAtTime(0.05, t); gain.gain.linearRampToValueAtTime(0, t + 0.05);
                osc.start(t); osc.stop(t + 0.05);
            } else if (type === 'overload') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(50, t);
                gain.gain.setValueAtTime(1, t); gain.gain.exponentialRampToValueAtTime(0.1, t + 0.5);
                osc.start(t); osc.stop(t + 0.5);
            }
        }

        document.addEventListener('contextmenu', e => {
            e.preventDefault();
            playSound('overload');
            document.body.classList.add('overload-flash');
            document.getElementById('warning-sign').style.display = 'block';
            setTimeout(() => {
                document.body.classList.remove('overload-flash');
                document.getElementById('warning-sign').style.display = 'none';
            }, 500);
        });

        function startWarmup() {
            if(isWarmedUp) return;
            initHum();
            playSound('clunk');
            playSound('spark');
            document.getElementById('ignite-btn').classList.add('active');
            document.getElementById('temp-needle').style.transform = "rotate(360deg)";
            humGain.gain.linearRampToValueAtTime(0.2, audioCtx.currentTime + 3);

            setTimeout(() => {
                isWarmedUp = true;
                document.getElementById('rack').classList.add('warmed-up');
                updateNixies();
            }, 300);
        }

        function pressKey(num) {
            if(!isWarmedUp || currentCode.length >= 4) return;
            playSound('clunk');
            playSound('nixie');
            currentCode += num;
            updateNixies();
        }

        function clearCode() {
            if(!isWarmedUp) return;
            playSound('clunk');
            currentCode = "";
            updateNixies();
        }

        function updateNixies() {
            for(let i=0; i<4; i++) {
                const tube = document.getElementById('n'+(i+1));
                tube.innerText = currentCode[i] !== undefined ? currentCode[i] : (isWarmedUp ? '0' : '');
                if(!isWarmedUp && currentCode[i] === undefined) tube.style.color = "rgba(255, 70, 0, 0.1)";
            }
        }

        function submitCode() {
            if(!isWarmedUp) return;
            playSound('clunk');

            if(currentCode === CLAVE_CORRECTA) {
                humOsc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 1);
                humGain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 1.5);
                document.getElementById('nixie-display').style.animation = "flash 0.2s infinite";

                setTimeout(() => {
                    // REDIRECCIÓN A APPWEB1.HTML
                    window.location.href = "appweb1.html";
                }, 1500);
            } else {
                isWarmedUp = false;
                document.getElementById('rack').classList.remove('warmed-up');
                document.getElementById('temp-needle').style.transform = "rotate(180deg)";
                document.getElementById('ignite-btn').classList.remove('active');
                humGain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
                playSound('spark');
                currentCode = "";
                setTimeout(updateNixies, 1000);
            }
        }

        // --- LÓGICA DE PANTALLA COMPLETA ---
        function activarPantallaCompleta() {
            const docEl = document.documentElement;
            if (!document.fullscreenElement) {
                if (docEl.requestFullscreen) {
                    docEl.requestFullscreen();
                } else if (docEl.webkitRequestFullscreen) { /* Safari */
                    docEl.webkitRequestFullscreen();
                } else if (docEl.msRequestFullscreen) { /* IE11 */
                    docEl.msRequestFullscreen();
                }
            }
        }

        document.addEventListener('click', activarPantallaCompleta);
        document.addEventListener('keydown', activarPantallaCompleta);

    </script>
</body>

</html>
